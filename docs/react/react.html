<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Event</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
    </head>
    <body class="vscode-light">
        <blockquote>
<h3 id="%e4%b8%ba%e4%bb%80%e4%b9%88%e8%a6%81%e5%81%9a%e8%bf%99%e4%b8%aa%e7%bd%91%e7%ab%99">ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªç½‘ç«™</h3>
</blockquote>
<ul>
<li><code>å­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹å¾ˆå¿«å°±å¿˜æ²¡å‡ å¤©åˆè¦é‡æ–°å­¦ä¹ </code></li>
<li><code>ç™¾åº¦æœç´¢æ¥çš„ç»“æœé™¤äº†å¹¿å‘Šå°±æ˜¯å„ç§å¤åˆ¶ç²˜è´´ç­”æ¡ˆï¼ŒçœŸæ­£å¯ç”¨èµ„æºå¾ˆå°‘</code></li>
<li><code>Googleæœç´¢ ä¸€èˆ¬äººåˆä¸ä¼šç§‘å­¦ä¸Šç½‘</code></li>
</ul>
<p>ç§äººè°·æ­Œçš„æ¦‚å¿µå°±æ˜¯ï¼šè·å¾—ä¸€ä¸ªçŸ¥è¯†ç‚¹åæŠŠæœ‰ç”¨çš„ä¿¡æ¯æ•´ç†å‡ºæ¥ï¼Œåˆ©ç”¨åˆ†ç±»æ•´ç†ï¼Œå˜æˆè‡ªå·±çš„ä¸œè¥¿</p>
<p>å»ºç«‹è‡ªå·±çš„çŸ¥è¯†é¢˜åº“ï¼Œä»è€ŒæŸ¥è¯¢åˆ†äº«ï¼Œæ‰“é€ ä¸€ä¸ªçº¯å‡€çš„çŸ¥è¯†ä½“ç³»åº“</p>
<blockquote>
<h3 id="react%e7%9f%a5%e8%af%86%e8%a6%81%e7%82%b9">ReactçŸ¥è¯†è¦ç‚¹</h3>
</blockquote>
<ul>
<li>Reacté»˜è®¤ï¼šçˆ¶ç»„ä»¶æ›´æ–°å­ç»„ä»¶åˆ™æ— æ¡ä»¶æ›´æ–° å¦‚éœ€æ€§èƒ½ä¼˜åŒ–</li>
<li>éœ€è¦åœ¨shouldComponentUpdateå‡½æ•°ä¸­åˆ¤æ–­ä¸éœ€è¦æ›´æ–°çš„æ•°å€¼ å¦‚æœæ²¡æœ‰å˜åŒ–åˆ™return false åˆ™å­ç»„ä»¶ä¸æ¸²æŸ“</li>
<li>shouldComponentUpdateä¸ä¸€å®šæ¯æ¬¡éƒ½è¦ä¼˜åŒ– éœ€è¦çš„æ—¶å€™æ‰å»ä¼˜åŒ– å¦‚æœå½±å“ä¸å¤§ å¯ä»¥ä¸ç”¨ä¼˜åŒ– ä»…ä»…æ˜¯ä¸€ä¸ªä¼˜åŒ–çš„é’©å­å‡½æ•°æš´éœ² è‡ªè¡Œå†³å®šä½¿ç”¨æˆ–è€…ä¸ä½¿ç”¨</li>
</ul>
<pre><code class="language-jsx"><div>    shouldComponentUpdate(nextProps, nextState) {
        <span class="hljs-keyword">if</span>(nextProps.text !== <span class="hljs-keyword">this</span>.props.text) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¯ä»¥æ¸²æŸ“</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ä¸é‡å¤æ¸²æŸ“</span>
    }

    <span class="hljs-comment">// å¦‚æœæ˜¯åˆ¤æ–­å¼•ç”¨ç±»å‹ å¯¹è±¡æˆ–è€…æ•°ç»„</span>
    <span class="hljs-comment">// const a = {a:1, b:2} const b = {a:1, b:2}</span>
    <span class="hljs-comment">// a === b  ç»“æœfalse å› ä¸ºæ˜¯æŒ‡é’ˆæŒ‡å‘ä¸åŒæ‰€ä»¥false</span>
    <span class="hljs-comment">// è¿™æ—¶å°±ç”¨_.isEqual åšå¯¹è±¡æˆ–è€…æ•°ç»„çš„æ·±åº¦æ¯”è¾ƒ</span>
    <span class="hljs-comment">// å¯ä»¥å‚è€ƒ https://lodash.com/docs/#isEqual</span>
    shouldComponentUpdate(nextProps, nextState) {
        <span class="hljs-comment">// _.isEqual åšå¯¹è±¡æˆ–è€…æ•°ç»„çš„æ·±åº¦æ¯”è¾ƒ(ä¸€æ¬¡æ€§é€’å½’åˆ°åº• è”æƒ³Vueçš„ObServeré€’å½’æ¯”è¾ƒ ä¸å»ºè®®ä½¿ç”¨)</span>
        <span class="hljs-comment">// æ‰€ä»¥åœ¨è®¾è®¡stateçš„æ—¶å€™ æ•°æ®ç»“æ„ä¸èƒ½åµŒå¥—çš„å¤ªæ·± å¦åˆ™æ·±åº¦æ¯”è¾ƒå¤ªæ…¢ æ€§èƒ½å¾ˆå·®</span>
        <span class="hljs-comment">// é‚£ä¹ˆæœ‰ä¸€ä¸ªæŠ€æœ¯é€‰æ‹©æ–¹æ¡ˆå°±æ˜¯æµ…æ¯”è¾ƒ(å°½é‡ä¸è¦æ·±æ¯”è¾ƒ) PureComponent(classç»„ä»¶) memo(å‡½æ•°ç»„ä»¶)</span>
        <span class="hljs-keyword">if</span>(_.isEqual(nextProps.list, <span class="hljs-keyword">this</span>.props.list)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// å¯ä»¥æ¸²æŸ“</span>
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-comment">// ä¸é‡å¤æ¸²æŸ“</span>
    }
</div></code></pre>
<h4 id="event">Event</h4>
<p><strong>reactä¸­çš„åˆæˆevent(SyntheticEvent ç»„åˆäº‹ä»¶)ï¼Œå¹¶éåŸç”Ÿçš„mouseEventï¼Œ vueä¸­çš„eventæ˜¯åŸç”Ÿçš„å¹¶ä¸”è§¦å‘æ—¶ç»‘å®šåœ¨å½“å‰çš„å…ƒç´ ; åˆ¤åˆ«åŸç”Ÿçš„Eventæ–¹å¼æ˜¯event.nativeEvent. reactä¸­event.nativeEvent.currentTargetæŒ‡å‘çš„æ˜¯document è€Œ Vueä¸­ event.nativeEvent.currentTarget æŒ‡å‘å½“å‰ç»‘å®šçš„å…ƒç´ </strong></p>
<ul>
<li>
<p>SyntheticEvent ç»„åˆäº‹ä»¶ï¼šæ¨¡æ‹ŸDOMå…ƒç´ eventäº‹ä»¶æ‰€æœ‰èƒ½åŠ›ï¼Œæ˜¯reactå°è£…çš„ä¸€å¥—äº‹ä»¶ç”±å†’æ³¡æœºåˆ¶å†’æ³¡åˆ°documentç„¶åé€šè¿‡SyntheticEventæ¥æ´¾å‘äº‹ä»¶åˆ°ç»‘å®šçš„targetå…ƒç´ ä¸Šé¢ï¼Œè€Œå¹¶éåŸç”Ÿeventäº‹ä»¶ï¼Œevent.nativeEventæ˜¯åŸç”Ÿäº‹ä»¶å¯¹è±¡</p>
</li>
<li>
<p>ä¼˜åŠ¿ï¼šæ›´å¥½çš„å…¼å®¹æ€§å’Œè·¨å¹³å°ï¼ˆå› ä¸ºSyntheticEvent ç»„åˆäº‹ä»¶ï¼‰ï¼Œå¦‚æœå®Œå…¨ä½¿ç”¨domäº‹ä»¶åœ¨ç§»åŠ¨ç«¯ä¸Šå¯èƒ½éœ€è¦é‡æ–°å†™ä¸€éäº‹ä»¶ç»‘å®š</p>
</li>
<li>
<p>ä¼˜åŠ¿ï¼šæŒ‚è½½åˆ°documentï¼Œå‡å°‘å†…å­˜æ¶ˆè€—ï¼Œé¿å…é¢‘ç¹è§£ç»‘</p>
</li>
<li>
<p>ä¼˜åŠ¿ï¼šæ–¹ä¾¿äº‹ä»¶çš„ç»Ÿä¸€ç®¡ç†ï¼ˆå¦‚äº‹åŠ¡æœºåˆ¶ï¼‰</p>
</li>
</ul>
<h4 id="setstate%e4%b8%ad%e7%9a%84%e4%b8%8d%e5%8f%af%e5%8f%98%e5%80%bc">setStateä¸­çš„ä¸å¯å˜å€¼</h4>
<ul>
<li><code>ä¸å¯å˜å€¼ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼Œçº¯å‡½æ•°ï¼‰</code></li>
<li>çº¯å‡½æ•°çš„æ¦‚å¿µåº”è¯¥æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š1. ç›¸åŒè¾“å…¥æ€»æ˜¯ä¼šè¿”å›ç›¸åŒçš„è¾“å‡ºã€‚2. ä¸äº§ç”Ÿå‰¯ä½œç”¨ã€‚ 3. ä¸ä¾èµ–äºå¤–éƒ¨çŠ¶æ€ã€‚</li>
</ul>
<pre><code class="language-jsx"><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
    <span class="hljs-keyword">constructor</span>(props) {
        <span class="hljs-keyword">super</span>(props);
        <span class="hljs-keyword">this</span>.state = {
            <span class="hljs-attr">value</span>: <span class="hljs-literal">null</span>,
        };
    }

    render() {
        <span class="hljs-keyword">return</span> ( 
           <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{this.state.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>
           &lt;button onClick={<span class="hljs-keyword">this</span>.increase}&gt;+<span class="hljs-number">1</span>&lt;<span class="hljs-regexp">/button&gt;
        );
    }

    increase = () =&gt; {
        /</span><span class="hljs-regexp">/ ä¸å¯å˜å€¼ - èµ‹å€¼
`æ­£ç¡®å†™æ³•` 
        this.setState({
            count: this.state.count + 1; 
        });
        
`é”™è¯¯å†™æ³•` 
        this.state.count++;
        this.setState({
            count: this.state.count
        });

`é”™è¯¯å†™æ³•` 
        this.setState({
            count: this.state.count++; 
        });

        /</span><span class="hljs-regexp">/ ------ æˆ‘æ˜¯åˆ†å‰²çº¿ ------
        /</span><span class="hljs-regexp">/ ä¸å¯å˜å€¼ - æ•°ç»„
        const list5Copy = this.state.list5.slice(); /</span><span class="hljs-regexp">/ ç›¸å½“äºlist5è¢«æ‹·è´äº†ä¸€ä»½
        list5Copy.splice(2, 0, 'a'); /</span><span class="hljs-regexp">/ ä¸­é—´æ’å…¥/</span>åˆ é™¤
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">list1</span>: <span class="hljs-keyword">this</span>.state.list1.concat(<span class="hljs-number">100</span>), <span class="hljs-comment">// è¿½åŠ </span>
            list2: [...this.state.list2, <span class="hljs-number">100</span>], <span class="hljs-comment">// è¿½åŠ </span>
            list3: <span class="hljs-keyword">this</span>.state.list3.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>), <span class="hljs-comment">// æˆªå–</span>
            list4: <span class="hljs-keyword">this</span>.state.list4.filter(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span>item &gt; <span class="hljs-number">100</span>), <span class="hljs-comment">// ç­›é€‰</span>
            list5: list5Copy; <span class="hljs-comment">// å…¶ä»–æ“ä½œ</span>
        });

        <span class="hljs-comment">// æ³¨æ„, ä¸èƒ½ç›´æ¥å¯¹ this.state.listè¿›è¡Œ push pop spliceç­‰, è¿åä¸å¯å˜å€¼</span>
        <span class="hljs-comment">// å› ä¸ºå¦‚æœç›´æ¥ä¿®æ”¹åŸæ•°ç»„ åœ¨shouldComponentUpdateåšä¼˜åŒ–çš„æ—¶å€™ ä¼šå‡ºBUG stateå·²ç»è¢«æ”¹å˜åˆ™å¯¹æ¯”æ²¡æœ‰æ”¹å˜æ‰€ä»¥å°±è¿”å›false ç»„ä»¶ä¸æ¸²æŸ“</span>
    
        <span class="hljs-comment">// ä¸å¯å˜å€¼ - å¯¹è±¡</span>
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">obj1</span>: <span class="hljs-built_in">Object</span>.assign({}, <span class="hljs-keyword">this</span>.state.obj1, {<span class="hljs-attr">a</span>: <span class="hljs-number">100</span>}),
            <span class="hljs-attr">obj2</span>: {...this.state.obj2, <span class="hljs-attr">a</span>: <span class="hljs-number">100</span>}
        });
        <span class="hljs-comment">// æ³¨æ„, ä¸èƒ½ç›´æ¥å¯¹ this.state.obj è¿›è¡Œå±æ€§è®¾ç½®ï¼Œè¿™æ ·è¿åä¸å¯å˜å€¼</span>
    }
}
</div></code></pre>
<ul>
<li><code>å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°</code></li>
</ul>
<pre><code class="language-jsx"><div>
    <span class="hljs-comment">// å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°(æœ‰å¯èƒ½æ˜¯åŒæ­¥æ›´æ–°)</span>
    <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
    }, () =&gt; {
        <span class="hljs-comment">// è”æƒ³vueä¸­çš„$nextTick</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'callback: '</span>, <span class="hljs-keyword">this</span>.state.count);  <span class="hljs-comment">// å›è°ƒå‡½æ•°ä¸­ å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„å€¼</span>
    });
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'count'</span>, <span class="hljs-keyword">this</span>.state.count); <span class="hljs-comment">// å¼‚æ­¥æ¸²æŸ“ æ‹¿ä¸åˆ°æœ€æ–°çš„å€¼</span>

    <span class="hljs-comment">// setTimeout ä¸­ setState æ˜¯åŒæ­¥çš„</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>;
        });
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'count in setTimeout: '</span>, <span class="hljs-keyword">this</span>.state.count);
    }, <span class="hljs-number">0</span>)

    <span class="hljs-comment">// ------ æˆ‘æ˜¯åˆ†å‰²çº¿ ------</span>

    <span class="hljs-comment">// è‡ªå®šä¹‰DOMäº‹ä»¶ï¼ŒsetStateæ˜¯åŒæ­¥çš„</span>
    bodyClickHandler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
        });
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'count in body event: '</span>, <span class="hljs-keyword">this</span>.state.count);
    }

    componentDidMount() {
        <span class="hljs-built_in">document</span>.body.addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.bodyClickHandler);
    }

    <span class="hljs-comment">// è”æƒ³ vue beforeDestroy éœ€è¦æ‰‹åŠ¨è§£ç»‘è‡ªå®šä¹‰äº‹ä»¶ è‡ªå®šä¹‰äº‹ä»¶éœ€è¦event.$offè§£ç»‘</span>
    componentWillUnmount() {
        <span class="hljs-built_in">document</span>.body.removeEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-keyword">this</span>.bodyClickHandler);
        <span class="hljs-comment">// å¦‚æœæœ‰è®¡æ—¶å™¨ ä¹Ÿéœ€è¦clearTimeoutæ¸…é™¤</span>
    }

</div></code></pre>
<ul>
<li><code>å¯èƒ½ä¼šè¢«åˆå¹¶</code></li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-comment">// stateå¼‚æ­¥æ›´æ–°çš„è¯ï¼Œæ›´æ–°å‰ä¼šè¢«åˆå¹¶</span>
    <span class="hljs-comment">// ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶ (Object.assign)ï¼Œæ‰§è¡Œç»“æœåªæœ‰ä¸€æ¬¡ +1</span>
    <span class="hljs-comment">// è”æƒ³vue  viewmodel dataåœ¨å“åº”æ›´æ–°çš„æ—¶å€™ å…ˆå‹å…¥æ ˆ å¦‚æœç›¸åŒä¹Ÿå°±æ‰§è¡Œä¸€æ¬¡å¤šä½™çš„è¢«èˆå¼ƒ</span>
    <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
    });
    <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
    });
    <span class="hljs-keyword">this</span>.setState({
        <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
    });
    <span class="hljs-comment">// å·®ä¸å¤šè¿™æ · Object.assign({ count: 1},{ count: 1},{ count: 1}) =&gt; {count : 1}</span>

    <span class="hljs-comment">// ä¼ å…¥å‡½æ•°ï¼Œä¸ä¼šè¢«åˆå¹¶(å› ä¸ºå‡½æ•°æ˜¯æ‰§è¡Œä»£ç æ— æ³•åƒå¯¹è±¡ä¸€æ ·åˆå¹¶æˆæ–°å€¼)ï¼Œ æ‰§è¡Œç»“æœæ˜¯ +3</span>
    <span class="hljs-keyword">this</span>.setState(<span class="hljs-function">(<span class="hljs-params">preState, props</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">count</span>: preState.count + <span class="hljs-number">1</span>
        }
    });
    <span class="hljs-keyword">this</span>.setState(<span class="hljs-function">(<span class="hljs-params">preState, props</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">count</span>: preState.count + <span class="hljs-number">1</span>
        }
    });
    <span class="hljs-keyword">this</span>.setState(<span class="hljs-function">(<span class="hljs-params">preState, props</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">count</span>: preState.count + <span class="hljs-number">1</span>
        }
    });
</div></code></pre>
<ul>
<li>setStateåŒæ­¥æ›´æ–°å’Œå¼‚æ­¥æ›´æ–°çš„åŸç† é€šè¿‡æ•è· isBatchingUpdateså€¼ trueæ˜¯å¼‚æ­¥è¡¨æ˜å‘½ä¸­batchUpdateæœºåˆ¶ falseæ˜¯åŒæ­¥</li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-comment">// è‡ªå®šä¹‰äº‹ä»¶</span>
    componentDidMount(){
        <span class="hljs-comment">// å¼€å§‹ï¼šå¤„äºbatchupdateæœºåˆ¶</span>
        <span class="hljs-comment">// reactæœºåˆ¶ä¼šé»˜è®¤æ‰§è¡Œ isBatchingUpdates = trueï¼Œä½†æ˜¯è¿™æ¡å®šä¹‰ä¸å­˜åœ¨äºå‡½æ•°ä½“ä¸­</span>
        <span class="hljs-built_in">document</span>.body.addeventListener(<span class="hljs-string">'click'</span>, () =&gt; {
            <span class="hljs-comment">// æ­¤æ—¶ isBatchingUpdates æ˜¯ false</span>
            <span class="hljs-keyword">this</span>.setState({
                <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
            });
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'count: '</span>, <span class="hljs-keyword">this</span>.state.count);
        });

        <span class="hljs-comment">// ç»“æŸ</span>
        <span class="hljs-comment">// é»˜è®¤æ‰§è¡Œ isBatchingUpdates = false</span>
    }

    increase = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// å¼€å§‹ï¼šå¤„äºbatchupdateæœºåˆ¶</span>
        <span class="hljs-comment">// isBatchingUpdates = trueï¼Œä½†æ˜¯è¿™æ¡å®šä¹‰ä¸å­˜åœ¨äºå‡½æ•°ä½“ä¸­</span>
        <span class="hljs-keyword">this</span>.setState({
            <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
        });

        <span class="hljs-comment">// ç»“æŸ</span>
        <span class="hljs-comment">// é»˜è®¤æ‰§è¡Œ isBatchingUpdates = false</span>
    }

    increase = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// å¼€å§‹ï¼šå¤„äºbatchupdateæœºåˆ¶</span>
        <span class="hljs-comment">// isBatchingUpdates = trueï¼Œä½†æ˜¯è¿™æ¡å®šä¹‰ä¸å­˜åœ¨äºå‡½æ•°ä½“ä¸­</span>
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{
            <span class="hljs-comment">// æ­¤æ—¶ï¼ŒisBatchingUpdates = false</span>
            <span class="hljs-keyword">this</span>.setState({
                <span class="hljs-attr">count</span>: <span class="hljs-keyword">this</span>.state.count + <span class="hljs-number">1</span>
            });
        }, <span class="hljs-number">0</span>)

        <span class="hljs-comment">// ç»“æŸ</span>
        <span class="hljs-comment">// é»˜è®¤æ‰§è¡Œ isBatchingUpdates = false</span>
    }

</div></code></pre>
<h4 id="%e4%bb%80%e4%b9%88%e6%98%af%e7%ba%af%e5%87%bd%e6%95%b0">ä»€ä¹ˆæ˜¯çº¯å‡½æ•°</h4>
<ul>
<li>çº¯å‡½æ•° ä»…è¾“å…¥props è¾“å‡ºjsxè¢«ç§°ä¹‹ä¸ºçº¯å‡½æ•°</li>
</ul>
<h4 id="%e9%9d%9e%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6">éå—æ§ç»„ä»¶</h4>
<ul>
<li>å®šä¹‰ : stateè®¾é»˜è®¤å€¼ åé¢å–å€¼å’Œstateæ— å…³</li>
<li>refs : React.createRef() åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡, å¹¶é€šè¿‡ ref å±æ€§é™„åŠ åˆ° React å…ƒç´ </li>
<li>defaultValue defaultChecked</li>
<li>æ‰‹åŠ¨æ“ä½œDOMå…ƒç´ </li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-keyword">this</span>.nameInputRef = React.createRef(); <span class="hljs-comment">// åˆ›å»ºref</span>
    <span class="hljs-keyword">this</span>.fileInputRef = React.createRef(); <span class="hljs-comment">// åˆ›å»ºref</span>

    render() {
        <span class="hljs-keyword">return</span> (
            &lt;div&gt;
                {/* ä½¿ç”¨defaultValueè€Œä¸æ˜¯valueï¼Œä½¿ç”¨ ref */}
                &lt;input defaultValue={this.state.name} ref={this.nameInputRef}&gt;
                {/* state å¹¶ä¸ä¼šéšç€æ”¹å˜ */}
                &lt;span&gt;state.name: {this.state.name}&lt;/span&gt;
                &lt;br&gt;
                &lt;button onClick={this.alertName}&gt;alert name&lt;/button&gt;
            &lt;/div&gt;
        )
    }

    alertName = () =&gt; {
        const elem = this.nameInputRef.current; // é€šè¿‡ref è·å– DOMèŠ‚ç‚¹
        alert(elem.value);
    }
    alertFile = () =&gt; {
        const elem = this.fileInputRef.current; // é€šè¿‡ref è·å– DOMèŠ‚ç‚¹
        alert(elem.files[0].name);
    }
</div></code></pre>
<h4 id="createportal">createPortal</h4>
<ul>
<li>å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆ</li>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆchildï¼‰æ˜¯ä»»ä½•å¯æ¸²æŸ“çš„ React å­å…ƒç´ ï¼Œä¾‹å¦‚ä¸€ä¸ªå…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ– fragmentã€‚ç¬¬äºŒä¸ªå‚æ•°ï¼ˆcontainerï¼‰æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚</li>
<li>é€šå¸¸ä¸ºäº†è§£å†³position:fixedçš„æ—¶å€™çš„å…¼å®¹é—®é¢˜</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šfixedéœ€è¦æ”¾åœ¨bodyç¬¬ä¸€å±‚ UCæµè§ˆå™¨å…¼å®¹é—®é¢˜</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šçˆ¶ç»„ä»¶ z-index å€¼å¤ªå°</li>
<li>ä½¿ç”¨åœºæ™¯ï¼šoverflow:hidden é€ƒç¦»çˆ¶ç»„ä»¶çš„éšè—</li>
</ul>
<pre><code class="language-jsx"><div>    reander(
        ReactDOM.createPortal(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"model"</span>&gt;</span>{this.props.children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>, <span class="hljs-built_in">document</span>.body);
    )
</div></code></pre>
<h4 id="createcontext">createContext</h4>
<ul>
<li>ä»ç»„ä»¶æ ‘ä¸­ç¦»è‡ªèº«æœ€è¿‘çš„é‚£ä¸ªåŒ¹é…çš„ Provider ä¸­è¯»å–åˆ°å½“å‰çš„ context å€¼</li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-keyword">const</span> MyContext = React.createContext(defaultValue);

    <span class="hljs-comment">// æä¾›è€…</span>
    &lt;MyContext.Provider value={<span class="hljs-keyword">this</span>.state[<span class="hljs-string">'è‡ªå®šä¹‰çš„stateçš„å€¼'</span>]}&gt;
        &lt;Demo /&gt;
    &lt;/MyContext.Provider&gt;

    // ------ åˆ†å‰²çº¿ æ¶ˆè´¹è€… ------

    // å¦‚æœæ˜¯å‡½æ•°ç»„ä»¶
    function Demo(props) {
        &lt;MyContext.Consumer&gt;
            {value =&gt; &lt;p&gt;{value}&lt;/p&gt;}
        &lt;/MyContext.Consumer&gt;
    }

    // å¦‚æœæ˜¯classç»„ä»¶
    class Demo extends React.Component{
`static contextType = MyContext ä¹Ÿå¯ä»¥ åœ¨classå¤–å®šä¹‰Demo.contextType = MyContext;` 
        render() {
            const value = this.context; // react ä¼šå¾€ä¸ŠæŸ¥è¯¢æœ€è¿‘åŒ¹é…çš„Provider
            return (
                &lt;div&gt;{value}&lt;/div&gt;
            )
        }
    }
`ç‰¹åˆ«å¼ºè°ƒ ä¹Ÿå¯ä»¥è¿™æ ·å†™ static contextType = MyContext` 
    Demo.contextType = MyContext;
</div></code></pre>
<h4 id="react-suspense-%e5%92%8c-reactlazy">React. Suspense å’Œ React.lazy</h4>
<ul>
<li>æ€§èƒ½ä¼˜åŒ–</li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-keyword">const</span> ContextDemo = React.lazy( <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {<span class="hljs-keyword">import</span>(<span class="hljs-string">'./ContextDemo'</span>)} )
    render() {
        <span class="hljs-keyword">return</span> (
            <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">React.Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
                    <span class="hljs-tag">&lt;<span class="hljs-name">ContextDemo</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">React.Suspense</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )
    }
</span></div></code></pre>
<h4 id="purecomponent-%e5%92%8c-memo">PureComponent å’Œ memo</h4>
<ul>
<li>PureComponentä¸­, shouldComponentUpdateä¸­å®ç°äº†æµ…æ¯”è¾ƒ</li>
<li>memo, å‡½æ•°ç»„ä»¶ä¸­çš„PureCom</li>
<li>_.isEqual åšå¯¹è±¡æˆ–è€…æ•°ç»„çš„æ·±åº¦æ¯”è¾ƒ(ä¸€æ¬¡æ€§é€’å½’åˆ°åº• è”æƒ³Vueçš„ObServeré€’å½’æ¯”è¾ƒ ä¸å»ºè®®ä½¿ç”¨)</li>
<li>æ‰€ä»¥åœ¨è®¾è®¡stateçš„æ—¶å€™ æ•°æ®ç»“æ„ä¸èƒ½åµŒå¥—çš„å¤ªæ·± å¦åˆ™æ·±åº¦æ¯”è¾ƒå¤ªæ…¢ æ€§èƒ½å¾ˆå·®</li>
<li>é‚£ä¹ˆæœ‰ä¸€ä¸ªæŠ€æœ¯é€‰æ‹©æ–¹æ¡ˆå°±æ˜¯æµ…æ¯”è¾ƒ(å°½é‡ä¸è¦æ·±æ¯”è¾ƒ) PureComponent(classç»„ä»¶) memo(å‡½æ•°ç»„ä»¶)</li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-comment">// PureComponent ç”¨æ³•</span>
    Class Demo extends React.PureComponent{

        render() {
             <span class="hljs-keyword">return</span>(
                <span class="hljs-comment">// jsx</span>
            )
        }
       shouldComponentUpdate() {
           <span class="hljs-comment">// æµ…æ¯”è¾ƒ</span>
       }
    }

    <span class="hljs-comment">// React.memo ç”¨æ³•</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Demo</span>(<span class="hljs-params">props</span>) </span>{
        <span class="hljs-comment">// ä½¿ç”¨propsæ¸²æŸ“</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">areEqual</span>(<span class="hljs-params">prevProps, nextProps</span>) </span>{
        <span class="hljs-comment">// å¦‚æœæŠŠ nextPropsä¼ å…¥ render æ–¹æ³•çš„è¿”å›ç»“æœ</span>
        <span class="hljs-comment">// ä¸</span>
        <span class="hljs-comment">// å°†prevPropsä¼ å…¥ renderæ–¹æ³•çš„è¿”å›ç»“æœä¸€è‡´</span>
        <span class="hljs-comment">// åˆ™è¿”å›trueå¦åˆ™è¿”å›false</span>
    }

    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> React.memo(Demo, areEqual);
</div></code></pre>
<ul>
<li>æ­¤æ–¹æ³•ä»…ä½œä¸ºæ€§èƒ½ä¼˜åŒ–å­˜åœ¨ã€‚ä¸è¦ä¾é å®ƒæ¥â€œé˜»æ­¢â€æ¸²æŸ“ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚</li>
</ul>
<h4 id="immutablejs-%e5%bd%bb%e5%ba%95%e6%8b%a5%e6%8a%b1-%e4%b8%8d%e5%8f%af%e5%8f%98%e5%80%bc">immutable.js å½»åº•æ‹¥æŠ± â€œä¸å¯å˜å€¼â€</h4>
<ul>
<li>å½»åº•æ‹¥æŠ± â€œä¸å¯å˜å€¼â€</li>
<li>åŸºäºå…±äº«æ•°æ®ï¼ˆä¸æ˜¯æ·±æ‹·è´ï¼‰ï¼Œé€Ÿåº¦å¿«</li>
<li>æœ‰ä¸€å®šå­¦ä¹ å’Œè¿ç§»æˆæœ¬ï¼ŒæŒ‰éœ€ä½¿ç”¨</li>
</ul>
<h4 id="%e5%85%ac%e5%85%b1%e9%80%bb%e8%be%91%e6%8a%bd%e7%a6%bb">å…¬å…±é€»è¾‘æŠ½ç¦»</h4>
<ul>
<li>mixin, å·²è¢«Reactå¼ƒç”¨</li>
<li>é«˜é˜¶ç»„ä»¶ HOC</li>
<li>Render Props</li>
</ul>
<pre><code class="language-jsx"><div>    <span class="hljs-comment">// é«˜é˜¶ç»„ä»¶ä¸æ˜¯ä¸€ç§åŠŸèƒ½ è€Œæ˜¯ä¸€ç§æ¨¡å¼</span>
    <span class="hljs-keyword">const</span> HOCFactory = <span class="hljs-function">(<span class="hljs-params">Component</span>) =&gt;</span> {
        Class HOC extends React.Component {
            <span class="hljs-comment">// å†æ¬¡å®šä¹‰å¤šä¸ªç»„ä»¶çš„å…¬å…±é€»è¾‘</span>
            render(){
                <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span> {<span class="hljs-attr">...this.props</span>} /&gt;</span> // è¿”å›æ‹¼è£…çš„ç»“æœ
            }
        }
        return HOC
    }
    const EnhancedComponent1 = HOCFactory(WrappedComponent1);
    const EnhancedComponent2 = HOCFactory(WrappedComponent2);
</span></div></code></pre>
<h4 id="batchupdate%e6%9c%ba%e5%88%b6">batchUpdateæœºåˆ¶</h4>
<ul>
<li>
<p>æœ¬è´¨ä¸ŠsetStateä¸å­˜åœ¨åŒæ­¥æˆ–è€…å¼‚æ­¥ï¼Œå®åˆ™æ˜¯æ•è·isBatchingUpdatesçš„å¸ƒå°”å€¼æ¥åˆ¤å®šæ˜¯å¦è§¦å‘batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>ç”Ÿå‘½å‘¨æœŸï¼ˆå’Œå®ƒè°ƒç”¨çš„å‡½æ•°ï¼‰å¯ä»¥å‘½ä¸­ğŸ¯batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>Reactä¸­æ³¨å†Œçš„äº‹ä»¶ï¼ˆå’Œå®ƒè°ƒç”¨çš„å‡½æ•°ï¼‰å¯ä»¥å‘½ä¸­ğŸ¯batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>ç»¼åˆæ¥çœ‹å°±æ˜¯ Reactå¯ä»¥â€œç®¡ç†â€çš„å…¥å£ï¼ˆå³åœ¨reacté‡Œæ³¨å†Œçš„ï¼‰ å¯ä»¥å‘½ä¸­ğŸ¯batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>setTimeout setIntervalç­‰ï¼ˆå’Œå®ƒè°ƒç”¨çš„å‡½æ•°ï¼‰ä¸å¯ä»¥å‘½ä¸­batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>è‡ªå®šä¹‰çš„DOMäº‹ä»¶ï¼ˆå’Œå®ƒè°ƒç”¨çš„å‡½æ•°ï¼‰ä¸å¯ä»¥å‘½ä¸­batchUpdateæœºåˆ¶</p>
</li>
<li>
<p>Reactâ€œç®¡ä¸åˆ°â€çš„å…¥å£ ä¸å¯ä»¥å‘½ä¸­batchUpdateæœºåˆ¶</p>
</li>
</ul>
<h4 id="transaction-%e4%ba%8b%e5%8a%a1%e6%9c%ba%e5%88%b6">transaction äº‹åŠ¡æœºåˆ¶</h4>
<pre><code class="language-jsx"><div>    increase = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// å¼€å§‹ï¼šå¤„äºbatchUpdate</span>
        <span class="hljs-comment">// isBatchingUpdates = true</span>

        <span class="hljs-comment">// å…¶ä»–æ“ä½œ</span>

        <span class="hljs-comment">//ç»“æŸ</span>
        <span class="hljs-comment">// isBatchingUpdates = false</span>
    }

    <span class="hljs-comment">// ----------------------------ä¸‹é¢è¿™å¹…å›¾æ˜¯reactä¸­çš„æµç¨‹æºç æ³¨é‡Š----------------------------</span>

    -                       wrappers (injected at creation time)
    -                                      +        +
    -                                      |        |
    -                    +-----------------|--------|--------------+
    -                    |                 v        |              |
    -                    |      +---------------+   |              |
    -                    |   +--|    wrapper1   |---|----+         |
    -                    |   |  +---------------+   v    |         |
    -                    |   |          +-------------+  |         |
    -                    |   |     +----|   wrapper2  |--------+   |
    -                    |   |     |    +-------------+  |     |   |
    -                    |   |     |                     |     |   |
    -                    |   v     v                     v     v   | wrapper
    -                    | +---+ +---+   +---------+   +---+ +---+ | invariants
    - perform(anyMethod) | |   | |   |   |         |   |   | |   | | maintained
    - +-----------------&gt;|-|---|-|---|--&gt;|anyMethod|---|---|-|---|-|--------&gt;
    -                    | |   | |   |   |         |   |   | |   | |
    -                    | |   | |   |   |         |   |   | |   | |
    -                    | |   | |   |   |         |   |   | |   | |
    -                    | +---+ +---+   +---------+   +---+ +---+ |
    -                    |  initialize                    close    |
    -                    +-----------------------------------------+

    * 

    - è¿™éƒ¨åˆ†çš„æµç¨‹å›¾å¯ä»¥è¿™æ ·å»ç†è§£ åœ¨æ³¨å…¥å’Œåˆ›å»ºçš„æ—¶å€™ä¼šé»˜è®¤ç©¿æ’initializeå’Œclose ç„¶åä¸­é—´ä¼šæ‰§è¡Œè‡ªå®šä¹‰å‡½æ•°
    - <span class="hljs-string">`ï¼ˆå¯å‚è€ƒhttps://github.com/zz1211/Doraemon/issues/9ï¼‰`</span> 
    - initialize -&gt; ç„¶åperform -&gt; ç„¶åclose

</div></code></pre>
<blockquote>
<h3 id="vue%e7%9b%b8%e5%85%b3%e7%9f%a5%e8%af%86%e8%a6%81%e7%82%b9">Vueç›¸å…³çŸ¥è¯†è¦ç‚¹</h3>
</blockquote>
<h4 id="hash%e6%a8%a1%e5%bc%8f-vue-router%e7%9a%84%e5%8e%9f%e7%90%86">hashæ¨¡å¼ Vue-Routerçš„åŸç†</h4>

    </body>
    </html>